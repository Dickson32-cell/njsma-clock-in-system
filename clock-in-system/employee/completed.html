<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attendance Complete - NJSMA</title>
  <link rel="stylesheet" href="../css/styles.css" />
  <script src="../js/scripts.js" defer></script>
</head>
<body>
  <header>
    <div class="logo">
      <img src="../assets/logo.png" alt="New Juaben South Municipal Assembly Logo" />
    </div>
    <nav>
      <ul>
        <li><a href="check-status.html">Check Another Employee</a></li>
        <li><a href="../index.html">Home</a></li>
        <li><a href="leave-request.html">Leave Request</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <div class="container">
      <section class="completion-section" role="main" aria-labelledby="completion-heading">
        <h2 id="completion-heading">‚úÖ Attendance Complete</h2>

        <!-- Progress Indicator -->
        <div class="progress-container" role="navigation" aria-label="Attendance process steps">
          <div class="progress-bar">
            <div class="progress-step completed">
              <div class="step-icon" aria-hidden="true">üîç</div>
              <div class="step-label">Check Status</div>
            </div>
            <div class="progress-step completed">
              <div class="step-icon" aria-hidden="true">üïê</div>
              <div class="step-label">Clock In</div>
            </div>
            <div class="progress-step completed">
              <div class="step-icon" aria-hidden="true">üïï</div>
              <div class="step-label">Clock Out</div>
            </div>
            <div class="progress-step completed active" aria-current="step">
              <div class="step-icon" aria-hidden="true">‚úÖ</div>
              <div class="step-label">Complete</div>
            </div>
          </div>
        </div>

        <!-- Completion Notice -->
        <div class="completion-notice" role="region" aria-label="Attendance completion status">
          <div class="success-icon">üéâ</div>
          <h3>Attendance Recorded Successfully!</h3>
          <p id="completionMessage">Your attendance has been recorded for today.</p>

          <div class="completion-details" id="completionDetails">
            <div class="detail-item">
              <span class="detail-label">Employee:</span>
              <span class="detail-value" id="completedEmployeeName"></span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Clocked In:</span>
              <span class="detail-value" id="completedClockInTime"></span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Clocked Out:</span>
              <span class="detail-value" id="completedClockOutTime"></span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Total Work Time:</span>
              <span class="detail-value" id="completedWorkDuration"></span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Location:</span>
              <span class="detail-value">EN-010-4770 (Assembly Premises)</span>
            </div>
            <div class="detail-item">
              <span class="detail-label">Status:</span>
              <span class="detail-value status-completed">Completed Successfully</span>
            </div>
          </div>
        </div>

        <!-- Next Steps -->
        <div class="next-steps">
          <h3>üìã What's Next?</h3>
          <div class="steps-list">
            <div class="step-item">
              <span class="step-number">1</span>
              <span class="step-text">Device is now available for the next employee</span>
            </div>
            <div class="step-item">
              <span class="step-number">2</span>
              <span class="step-text">You can check another employee's status or return to home</span>
            </div>
            <div class="step-item">
              <span class="step-number">3</span>
              <span class="step-text">Attendance records are automatically saved and can be viewed by HR</span>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="completion-actions">
          <a href="check-status.html" class="action-btn primary-btn">
            <span class="btn-icon">üîç</span>
            <span class="btn-text">Check Another Employee</span>
          </a>
          <a href="../index.html" class="action-btn secondary-btn">
            <span class="btn-icon">üè†</span>
            <span class="btn-text">Return to Home</span>
          </a>
        </div>

        <!-- Auto-redirect Notice -->
        <div id="autoRedirectNotice" class="auto-redirect-notice">
          <p>üîÑ This page will automatically redirect to check another employee in <span id="countdown">30</span> seconds...</p>
          <button onclick="cancelAutoRedirect()" class="cancel-btn">Cancel Auto-redirect</button>
        </div>
      </section>
    </div>
  </main>
  <footer>
    <p>&copy; 2025 New Juaben South Municipal Assembly. All rights reserved.</p>
  </footer>

  <script>
    // Auto-redirect functionality
    let countdownInterval;
    let countdownValue = 30;

    function startCountdown() {
      const countdownElement = document.getElementById('countdown');
      const redirectNotice = document.getElementById('autoRedirectNotice');

      countdownInterval = setInterval(() => {
        countdownValue--;
        countdownElement.textContent = countdownValue;

        if (countdownValue <= 0) {
          clearInterval(countdownInterval);
          window.location.href = 'check-status.html';
        }
      }, 1000);

      // Show redirect notice after 10 seconds
      setTimeout(() => {
        redirectNotice.style.display = 'block';
      }, 10000);
    }

    function cancelAutoRedirect() {
      clearInterval(countdownInterval);
      document.getElementById('autoRedirectNotice').style.display = 'none';
    }

    // Load completion data from URL parameters or session storage
    function loadCompletionData() {
      const urlParams = new URLSearchParams(window.location.search);

      const employeeName = urlParams.get('name') || 'Unknown Employee';
      const clockInTime = urlParams.get('clockIn') || '--:--';
      const clockOutTime = urlParams.get('clockOut') || '--:--';
      const workDuration = urlParams.get('duration') || '0 hours 0 minutes';

      document.getElementById('completedEmployeeName').textContent = employeeName;
      document.getElementById('completedClockInTime').textContent = clockInTime;
      document.getElementById('completedClockOutTime').textContent = clockOutTime;
      document.getElementById('completedWorkDuration').textContent = workDuration;

      document.getElementById('completionMessage').textContent =
        `${employeeName}'s attendance has been recorded successfully for today.`;
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      loadCompletionData();
      startCountdown();
    });
  </script>
</body>
</html>